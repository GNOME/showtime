#!@PYTHON@

# SPDX-License-Identifier: GPL-3.0-or-later
# SPDX-FileCopyrightText: Copyright 2024-2025 kramo

import os
import sys
import signal
from pathlib import Path
import locale
import gettext
from platform import system

pkgdatadir = "@pkgdatadir@"
localedir = "@localedir@"

sys.path.insert(1, pkgdatadir)
signal.signal(signal.SIGINT, signal.SIG_DFL)

if system() == "Linux":
    locale.bindtextdomain("@BIN_NAME@", localedir)
    locale.textdomain("@BIN_NAME@")
    gettext.install("@BIN_NAME@", localedir)
else:
    gettext.install("@BIN_NAME@")

if __name__ == "__main__":
    import gi

    gi.require_version("Gtk", "4.0")

    from gi.repository import Gio, GLib, Gtk

    GLib.set_prgname("@BIN_NAME@")
    GLib.set_application_name(_("Video Player"))
    Gtk.Window.set_default_icon_name("@APP_ID@")

    try:
        # For a macOS application bundle
        resource = Gio.Resource.load(
            str(Path(__file__).parent / "Resources" / "showtime.gresource")
        )
    except GLib.GError:
        resource = Gio.Resource.load(os.path.join(pkgdatadir, "showtime.gresource"))
    resource._register()

    import showtime

    sys.exit(showtime.main())
